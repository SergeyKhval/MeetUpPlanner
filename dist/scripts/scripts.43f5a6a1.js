"use strict";angular.module("meetUpPlannerApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ngMessages","firebase","firebase.ref","firebase.auth","ui.bootstrap","angular-location-picker"]),angular.module("meetUpPlannerApp").controller("MainCtrl",["$scope","Event",function(a,b){a.events=null,a.events=b.allEvents().$loaded().then(function(b){a.events=b})}]),angular.module("firebase.config",[]).constant("FBURL","https://udacity-web-form.firebaseio.com").constant("SIMPLE_LOGIN_PROVIDERS",["password"]).constant("loginRedirectPath","/login"),angular.module("firebase.ref",["firebase","firebase.config"]).factory("Ref",["$window","FBURL",function(a,b){return new a.Firebase(b)}]),angular.module("meetUpPlannerApp").filter("reverse",function(){return function(a){return angular.isArray(a)?a.slice().reverse():[]}}),function(){angular.module("firebase.auth",["firebase","firebase.ref"]).factory("Auth",["$firebaseAuth","Ref",function(a,b){return a(b)}])}(),angular.module("meetUpPlannerApp").controller("LoginCtrl",["$scope","Auth","User","$location",function(a,b,c,d){function e(){d.path("/event/add")}function f(b){a.err=b}a.passwordLogin=function(c,d){a.err=null,b.$authWithPassword({email:c,password:d},{rememberMe:!0}).then(e,f)},a.createAccount=function(a){a.password===a.confirm&&c.register(a).then(e,f)}}]),angular.module("meetUpPlannerApp").controller("AccountCtrl",["$scope","user","Auth","Ref","$firebaseObject","$timeout",function(a,b,c,d,e,f){function g(a){i(a,"danger")}function h(a){i(a,"success")}function i(b,c){var d={text:b+"",type:c};a.messages.unshift(d),f(function(){a.messages.splice(a.messages.indexOf(d),1)},1e4)}a.user=b,a.logout=function(){c.$unauth()},a.messages=[];var j=e(d.child("users/"+b.uid));j.$bindTo(a,"profile"),a.changePassword=function(b,d,e){a.err=null,b&&d?d!==e?g("Passwords do not match"):c.$changePassword({email:j.email,oldPassword:b,newPassword:d}).then(function(){h("Password changed")},g):g("Please enter all fields")},a.changeEmail=function(b,d){a.err=null,c.$changeEmail({password:b,newEmail:d,oldEmail:j.email}).then(function(){j.email=d,j.$save(),h("Email changed")})["catch"](g)}}]),angular.module("meetUpPlannerApp").directive("ngShowAuth",["Auth","$timeout",function(a,b){return{restrict:"A",link:function(c,d){function e(){b(function(){d.toggleClass("ng-cloak",!a.$getAuth())},0)}d.addClass("ng-cloak"),a.$onAuth(e),e()}}}]),angular.module("meetUpPlannerApp").directive("ngHideAuth",["Auth","$timeout",function(a,b){return{restrict:"A",link:function(c,d){function e(){b(function(){d.toggleClass("ng-cloak",!!a.$getAuth())},0)}d.addClass("ng-cloak"),a.$onAuth(e),e()}}}]),angular.module("meetUpPlannerApp").config(["$routeProvider","SECURED_ROUTES",function(a,b){a.whenAuthenticated=function(c,d){return d.resolve=d.resolve||{},d.resolve.user=["Auth",function(a){return a.$requireAuth()}],a.when(c,d),b[c]=!0,a}}]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl"}).whenAuthenticated("/account",{templateUrl:"views/account.html",controller:"AccountCtrl"}).when("/event/add",{templateUrl:"views/addevent.html",controller:"AddeventCtrl"}).when("/event/confirm",{templateUrl:"views/confirmevent.html",controller:"ConfirmeventCtrl"}).otherwise({redirectTo:"/"})}]).run(["$rootScope","$location","Auth","SECURED_ROUTES","loginRedirectPath",function(a,b,c,d,e){function f(a){!a&&g(b.path())&&b.path(e)}function g(a){return d.hasOwnProperty(a)}c.$onAuth(f),a.$on("$routeChangeError",function(a,c,d,f){"AUTH_REQUIRED"===f&&b.path(e)})}]).constant("SECURED_ROUTES",{}),angular.module("meetUpPlannerApp").controller("AddeventCtrl",["$scope","$location","Event",function(a,b,c){a.event=c.getRememberedEvent(),a.rememberEvent=function(a,d){a.$valid&&(c.rememberEvent(d),b.path("/event/confirm"))},a.eventtypes=["Party","Meeting","Conference","Dinner","Seminar","Charity","Award ceremony"],a.dateOptions={formatYear:"yy",startingDay:1,showWeeks:!1},a.openedPopups={startDate:!1,endDate:!1},a.openDatePopup=function(b){a.openedPopups[b]=!0},a.timePicker={hstep:1,mstep:15},a.mapoptions={autocomplete:!0,inputName:"#google-map-locator-address"},a.location={latitude:12.8139068,longitude:77.6516683}}]),angular.module("meetUpPlannerApp").controller("ConfirmeventCtrl",["$location","$scope","Auth","Event","User",function(a,b,c,d,e){function f(a){console.log(a)}function g(){d.rememberEvent({}),a.path("#/")}function h(b){d.createEvent(b).then(function(){d.rememberEvent({}),a.path("#/")})}function i(){h(b.event)}function j(a){b.err=null,c.$authWithPassword({email:a.email,password:a.password},{rememberMe:!0}).then(function(){h(b.event)},f)}function k(a){a.password===a.confirm&&e.register(a).then(i,f)}b.event=d.getRememberedEvent(),b.loginMode=!0,b.confirmEvent=h,b.cancelEvent=g,b.loginAndCreateEvent=j,b.registerAndCreateEvent=k}]),angular.module("meetUpPlannerApp").directive("activeMenuPath",["$location",function(a){return{restrict:"A",link:function(b,c,d){var e="active",f=d.activeMenuPath;b.location=a,b.$watch("location.path()",function(a){return a=a.split("/")[1],a===f?c.addClass(e):c.removeClass(e)})}}}]),angular.module("meetUpPlannerApp").factory("Event",["Ref","$firebaseArray",function(a,b){function c(a){return a.startdate=a.startdate.getTime(),a.starttime=a.starttime.getTime(),a.enddate=a.enddate.getTime(),a.endtime=a.endtime.getTime(),a.createdAt=Firebase.ServerValue.TIMESTAMP,i.$add(a)}function d(){return i}function e(a){return g=a}function f(){return g}var g,h=a.child("events"),i=b(h);return{createEvent:c,rememberEvent:e,getRememberedEvent:f,allEvents:d}}]),angular.module("meetUpPlannerApp").controller("NavbarCtrl",["$scope","$location","Auth",function(a,b,c){a.logout=function(){c.$unauth(),b.path("#/")}}]),angular.module("meetUpPlannerApp").factory("User",["Auth","$location","$q","Ref","$timeout",function(a,b,c,d,e){var f={};return f.register=function(b){function f(a){var f=d.child("users/"+a.uid),g=c.defer();return f.set({email:b.email,name:b.name,employer:b.employer,position:b.position},function(a){e(function(){a?g.reject(a):g.resolve(f)})}),g.promise}return a.$createUser({email:b.email,password:b.password}).then(function(){return a.$authWithPassword({email:b.email,password:b.password},{rememberMe:!0})}).then(f)},f}]);